"use strict";(self.webpackChunkinventory_management_ui=self.webpackChunkinventory_management_ui||[]).push([[8],{8008:(Ne,I,c)=>{c.r(I),c.d(I,{EstimationModule:()=>Ee});var u=c(6814),g=c(1896),r=c(5313),_=c(3365),E=c(3514),t=c(5879),h=c(788),Z=c(5619),U=c(4173);let v=(()=>{class i{constructor(e){this.apiService=e,this.selectedEstimationItemsSubject=new Z.X([]),this.selectedEstimationItems$=this.selectedEstimationItemsSubject.asObservable(),this.isAddMoreEstimationItemsSubject=new Z.X(!1),this.isAddMoreItems$=this.isAddMoreEstimationItemsSubject.asObservable(),this.customerDetailsSubject=new Z.X(null),this.customerDetails$=this.customerDetailsSubject.asObservable()}getEstimationData(){return this.apiService.httpGet(h.$.api.estimations)}addToCart(e){this.selectedEstimationItemsSubject.next([]);const n=[...this.selectedEstimationItemsSubject.getValue(),...e];this.selectedEstimationItemsSubject.next(n)}setIsAddMoreItems(e){this.isAddMoreEstimationItemsSubject.next(e)}setCustomerDetails(e){this.customerDetailsSubject.next(e)}getOrganization(){return this.apiService.httpGet(h.$.api.organizations)}getEstimationInvoice(e){return this.apiService.httpGet(`search/invoice/${e}`)}getProductItems(){return this.apiService.httpPost("products/getProductItems",{productId:"0dcdab9d-47f1-4b16-b777-b092d5697022",categoryId:"3a222297-2e04-4323-91f4-2bdaa2268be7",categoryTypeId:"06f57701-23c2-465b-b553-abcc2141aaa0",page:1,pageSize:20,sortBy:"itemName",sortDir:"ASC"})}searchCustomers(e){return this.apiService.httpPost(h.$.api.searchCustomers,e)}searchProductItems(e){return this.apiService.httpPost(h.$.api.searchProductItems,e)}getSaleType(){return this.apiService.httpGet("utils/sale-types")}createEstimation(e){return this.apiService.httpPost(h.$.api.estimations,e)}createCustomer(e){return this.apiService.httpPost(h.$.api.customers,e)}static#t=this.\u0275fac=function(a){return new(a||i)(t.LFG(U.s))};static#e=this.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var p=c(9157),x=c(2032),d=c(5195),l=c(6223),f=c(2296),T=c(617),N=c(2465);function Q(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",14),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.clearSearch())}),t.TgZ(1,"mat-icon"),t._uU(2,"close"),t.qZA()()}}function w(i,o){if(1&i&&(t.TgZ(0,"mat-header-cell",18),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit,a=t.oxw();t.xp6(1),t.hij(" ",a.Headings[e]," ")}}function S(i,o){if(1&i&&(t.ynx(0),t.TgZ(1,"div",21)(2,"div")(3,"span"),t._uU(4),t.qZA()(),t.TgZ(5,"div")(6,"h3",22),t._uU(7),t.qZA(),t.TgZ(8,"h3",23),t._uU(9),t.qZA()()(),t.BQk()),2&i){const e=t.oxw().$implicit;t.xp6(4),t.Oqu(e.customer.customerName.slice(0,1)),t.xp6(3),t.Oqu(e.customer.customerName),t.xp6(2),t.Oqu(e.customer.contactNumber)}}function k(i,o){if(1&i&&(t.ynx(0),t.TgZ(1,"span"),t._uU(2),t.ALo(3,"dateStrFormat"),t.qZA(),t.BQk()),2&i){const e=t.oxw().$implicit,a=t.oxw().$implicit;t.xp6(2),t.Oqu(t.lcZ(3,1,e[a]))}}function O(i,o){if(1&i&&(t.ynx(0),t.TgZ(1,"span"),t._uU(2),t.qZA(),t.BQk()),2&i){const e=t.oxw().$implicit,a=t.oxw().$implicit;t.xp6(2),t.Oqu(e[a])}}function J(i,o){if(1&i&&(t.ynx(0),t.TgZ(1,"div",24)(2,"span"),t._uU(3),t.qZA()(),t.BQk()),2&i){const e=t.oxw().$implicit,a=t.oxw().$implicit;t.xp6(3),t.Oqu(e[a])}}function Y(i,o){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",25),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,s=t.oxw(2);return t.KtG(s.getEstimationInvoice(n.invoiceId))}),t.TgZ(2,"mat-icon"),t._uU(3,"ios_share"),t.qZA()(),t.BQk()}}function M(i,o){if(1&i&&(t.TgZ(0,"mat-cell",19),t.YNc(1,S,10,3,"ng-container",20),t.YNc(2,k,4,3,"ng-container",20),t.YNc(3,O,3,1,"ng-container",20),t.YNc(4,J,4,1,"ng-container",20),t.YNc(5,Y,4,0,"ng-container",20),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf","customerInfo"===e),t.xp6(1),t.Q6J("ngIf","estimationDate"===e),t.xp6(1),t.Q6J("ngIf","invoiceId"===e),t.xp6(1),t.Q6J("ngIf","subTotal"===e),t.xp6(1),t.Q6J("ngIf","action"===e)}}function F(i,o){1&i&&(t.ynx(0,15),t.YNc(1,w,2,1,"mat-header-cell",16),t.YNc(2,M,6,5,"mat-cell",17),t.BQk()),2&i&&t.Q6J("matColumnDef",o.$implicit)}function P(i,o){1&i&&(t.TgZ(0,"div",26)(1,"td",27),t._uU(2,"No data found"),t.qZA()())}function B(i,o){1&i&&t._UZ(0,"mat-header-row")}function $(i,o){1&i&&t._UZ(0,"mat-row")}const j=function(){return[5,10,20]};let z=(()=>{class i{constructor(e,a){this.service=e,this.router=a,this.value="",this.dataSource=new r.by,this.allEstimation=[],this.displayedColumns=["customerInfo","invoiceId","estimationDate","subTotal","action"],this.pageSizeOptions=[5,10,25,100],this.Headings=E.O}ngOnInit(){this.getData()}ngAfterViewInit(){this.dataSource.paginator=this.paginator}getEstimationInvoice(e){this.router.navigate(["/dashboard/estimations/invoice"],{queryParams:{invoiceId:e}})}goToCart(){this.router.navigate(["/dashboard/estimations/cart"])}moveToCreateEstimation(){this.router.navigate(["/dashboard/estimations/addEstimation"])}getData(){this.service.getEstimationData().subscribe({next:e=>{this.dataSource.data=e,this.allEstimation=e},error:e=>{console.log("error => ",e)}})}searchEstimationInvoice(e){this.dataSource.data=""!==this.value?this.allEstimation.filter(a=>a.invoiceId.startsWith(e.toUpperCase())):this.allEstimation}clearSearch(){this.value="",this.dataSource.data=this.allEstimation}static#t=this.\u0275fac=function(a){return new(a||i)(t.Y36(v),t.Y36(g.F0))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-estimation-list"]],viewQuery:function(a,n){if(1&a&&t.Gf(_.NW,5),2&a){let s;t.iGM(s=t.CRH())&&(n.paginator=s.first)}},decls:20,vars:8,consts:[[1,"card-header"],[1,"heading"],["mat-raised-button","",1,"primary-button",3,"click"],["appearance","outline","subscriptSizing","dynamic",1,"search"],["matPrefix",""],["type","text","matInput","","placeholder","Find Estimation Invoice",3,"ngModel","ngModelChange","input"],["matSuffix","","mat-icon-button","",3,"click",4,"ngIf"],[1,"div-scroll"],["mat-table","",1,"mat-table",3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],["class","d-flex justify-content-center",4,"matNoDataRow"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSizeOptions"],["matSuffix","","mat-icon-button","",3,"click"],[3,"matColumnDef"],["class","mat-table-head",4,"matHeaderCellDef"],["class","mat-table-cell",4,"matCellDef"],[1,"mat-table-head"],[1,"mat-table-cell"],[4,"ngIf"],[1,"customer_info"],[1,"title"],[1,"subTitle"],[1,"align_Start"],["mat-icon-button","",1,"action",3,"click"],[1,"d-flex","justify-content-center"],[1,"mat-cell"]],template:function(a,n){1&a&&(t.TgZ(0,"mat-card")(1,"div",0)(2,"h1",1),t._uU(3,"Estimation"),t.qZA(),t.TgZ(4,"button",2),t.NdJ("click",function(){return n.moveToCreateEstimation()}),t._uU(5," New Estimation "),t.qZA()(),t.TgZ(6,"mat-card-content")(7,"mat-form-field",3)(8,"mat-icon",4),t._uU(9,"search"),t.qZA(),t.TgZ(10,"input",5),t.NdJ("ngModelChange",function(m){return n.value=m})("input",function(){return n.searchEstimationInvoice(n.value)}),t.qZA(),t.YNc(11,Q,3,0,"button",6),t.qZA(),t.TgZ(12,"div",7)(13,"mat-table",8),t.YNc(14,F,3,1,"ng-container",9),t.YNc(15,P,3,0,"div",10),t.YNc(16,B,1,0,"mat-header-row",11),t.YNc(17,$,1,0,"mat-row",12),t.qZA()()(),t.TgZ(18,"mat-card-footer"),t._UZ(19,"mat-paginator",13),t.qZA()()),2&a&&(t.xp6(10),t.Q6J("ngModel",n.value),t.xp6(1),t.Q6J("ngIf",""!==n.value),t.xp6(2),t.Q6J("dataSource",n.dataSource),t.xp6(1),t.Q6J("ngForOf",n.displayedColumns),t.xp6(2),t.Q6J("matHeaderRowDef",n.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",n.displayedColumns),t.xp6(2),t.Q6J("pageSizeOptions",t.DdM(7,j)))},dependencies:[u.sg,u.O5,p.KE,p.qo,p.R9,x.Nt,d.a8,d.dn,d.rt,l.Fj,l.JJ,l.On,f.lW,f.RK,r.BZ,r.fO,r.as,r.w1,r.Dz,r.nj,r.ge,r.ev,r.XQ,r.Gk,r.Ee,T.Hw,_.NW,N.d]})}return i})();var D=c(8180),H=c(1260),L=c(2529),R=c(1264),A=c(2939),G=c(8523),q=c(5986),W=c(8525),V=c(3680);function K(i,o){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"Contact Number is required"),t.qZA())}function X(i,o){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"Number must be 10 digits"),t.qZA())}function tt(i,o){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"Customer Name is required"),t.qZA())}function et(i,o){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"Name must be at least 4 characters"),t.qZA())}function it(i,o){if(1&i&&(t.TgZ(0,"mat-option",41),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.Q6J("value",e.productId),t.xp6(1),t.Oqu(e.productName)}}function at(i,o){if(1&i&&(t.TgZ(0,"mat-option",41),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.Q6J("value",e.categoryId),t.xp6(1),t.Oqu(e.categoryName)}}function nt(i,o){if(1&i&&(t.TgZ(0,"mat-option",41),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.Q6J("value",e.categoryTypeId),t.xp6(1),t.Oqu(e.categoryTypeName)}}function ot(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",42),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.itemNameOrCode="")}),t.TgZ(1,"mat-icon"),t._uU(2,"close"),t.qZA()()}}function st(i,o){1&i&&(t.TgZ(0,"div"),t._UZ(1,"app-spinner"),t.qZA())}function rt(i,o){1&i&&t._uU(0,"Search")}function mt(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",42),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.itemNameOrCode="")}),t.TgZ(1,"mat-icon"),t._uU(2,"close"),t.qZA()()}}function ct(i,o){1&i&&(t.TgZ(0,"th",43),t._uU(1," Selected "),t.qZA())}function lt(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"td",44)(1,"mat-checkbox",45),t.NdJ("change",function(){const s=t.CHM(e).$implicit,m=t.oxw();return t.KtG(m.toggleSelection(s))}),t.qZA()()}if(2&i){const e=o.$implicit,a=t.oxw();t.xp6(1),t.Q6J("checked",a.isSelectedItem(e))}}function dt(i,o){1&i&&(t.TgZ(0,"th",43),t._uU(1,"Item Name"),t.qZA())}function ut(i,o){if(1&i&&(t.TgZ(0,"td",44)(1,"div",46),t._UZ(2,"img",47),t.TgZ(3,"div",48)(4,"h3",2),t._uU(5),t.qZA(),t.TgZ(6,"p",49),t._uU(7),t.qZA()()()()),2&i){const e=o.$implicit,a=t.oxw();t.xp6(2),t.Q6J("src",e.image?a.baseURLImages+e.image:"../../../../assets/images/No_Image.jpg",t.LSH),t.xp6(3),t.Oqu(e.itemName),t.xp6(2),t.Oqu(e.companyName)}}function pt(i,o){1&i&&(t.TgZ(0,"th",43),t._uU(1,"Sale Price"),t.qZA())}function gt(i,o){1&i&&(t.TgZ(0,"p",54),t._uU(1," Invalid Price "),t.qZA())}function ht(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"td",50)(1,"mat-form-field",51)(2,"mat-icon",15),t._uU(3,"currency_rupee"),t.qZA(),t.TgZ(4,"input",52),t.NdJ("ngModelChange",function(n){const m=t.CHM(e).$implicit;return t.KtG(m.salePrice=n)})("change",function(){const s=t.CHM(e).$implicit,m=t.oxw();return t.KtG(m.formatSalePrice(s))})("focus",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.emptyValue(n))}),t.qZA()(),t.YNc(5,gt,2,0,"p",53),t.qZA()}if(2&i){const e=o.$implicit,a=t.oxw();t.xp6(4),t.Q6J("ngModel",e.salePrice),t.xp6(1),t.Q6J("ngIf",a.isSelectedItem(e)&&"NaN"===e.salePrice&&a.isClicked||a.isSelectedItem(e)&&a.isClicked&&e.salePrice<"1")}}function _t(i,o){1&i&&(t.TgZ(0,"th",43),t._uU(1,"Item Code"),t.qZA())}function ft(i,o){if(1&i&&(t.TgZ(0,"td",44),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.Oqu(e.itemCode)}}function Ct(i,o){1&i&&(t.TgZ(0,"th",43),t._uU(1,"Description"),t.qZA())}function bt(i,o){if(1&i&&(t.TgZ(0,"td",44)(1,"div",55),t._uU(2),t.qZA()()),2&i){const e=o.$implicit;t.xp6(2),t.Oqu(e.description)}}function vt(i,o){1&i&&(t.TgZ(0,"th",43),t._uU(1,"Quantity"),t.qZA())}function Tt(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"td",44)(1,"div",56)(2,"mat-form-field",51)(3,"button",57),t.NdJ("click",function(){const s=t.CHM(e).$implicit,m=t.oxw();return t.KtG(m.decrementQuantity(s))}),t.TgZ(4,"mat-icon"),t._uU(5,"remove"),t.qZA()(),t.TgZ(6,"input",58),t.NdJ("ngModelChange",function(n){const m=t.CHM(e).$implicit;return t.KtG(m.totalQuantity=n)})("keyup",function(){const s=t.CHM(e).$implicit,m=t.oxw();return t.KtG(m.validateQuantity(s))}),t.qZA(),t.TgZ(7,"button",59),t.NdJ("click",function(){const s=t.CHM(e).$implicit,m=t.oxw();return t.KtG(m.incrementQuantity(s))}),t.TgZ(8,"mat-icon"),t._uU(9,"add"),t.qZA()()()(),t.TgZ(10,"p",60),t._uU(11),t.qZA()()}if(2&i){const e=o.$implicit;t.xp6(3),t.Q6J("disabled",e.totalQuantity<1),t.xp6(3),t.Q6J("ngModel",e.totalQuantity),t.xp6(1),t.Q6J("disabled",e.totalQuantity>=e.availableQuantity),t.xp6(3),t.ekj("text_danger",e.availableQuantity<1),t.xp6(1),t.hij("Available : ",e.availableQuantity,"")}}function Zt(i,o){1&i&&t._UZ(0,"tr",61)}function xt(i,o){1&i&&t._UZ(0,"tr",62)}function yt(i,o){if(1&i&&(t.ynx(0),t.TgZ(1,"tr",63)(2,"td",64),t._uU(3,"No data found"),t.qZA()(),t.BQk()),2&i){const e=t.oxw();t.xp6(2),t.uIk("colspan",e.displayColumns.length)}}const It=function(){return[10,20,50]};let Et=(()=>{class i{constructor(e,a,n,s,m,C,b){this.service=e,this.router=a,this.fb=n,this.productService=s,this.categoryService=m,this.categoryTypeService=C,this.snackBar=b,this.productDetails=[],this.categoryDetails=[],this.categoryTypeDetails=[],this.displayColumns=["select","itemName","itemCode","description","salePrice","quantity"],this.dataSource=new r.by([]),this.selectedEstimationItems=[],this.customerForm=new l.cw({}),this.customerNameReadOnly=!0,this.customersData=[],this.customersAutoOptions=[],this.baseURLImages=h.$.api.baseUrl,this.itemNameOrCode="",this.isClicked=!1,this.searchForm=new l.cw({}),this.isSpinnerLoading=!1}ngOnInit(){this.createCustomerForm(),this.createSearchForm(),this.getProductDetails(),this.updateCart()}ngAfterViewInit(){this.dataSource.paginator=this.paginator}createSearchForm(){this.searchForm=this.fb.group({productId:[""],categoryId:[""],categoryTypeId:[""]})}updateCart(){this.selectedEstimationItems=[],this.service.isAddMoreItems$.pipe((0,D.q)(1)).subscribe(e=>{e&&(this.service.selectedEstimationItems$.subscribe(a=>{a&&a.length>0&&(this.selectedEstimationItems=a)}),this.service.customerDetails$.subscribe(a=>{if(a){this.customerForm.get("customerName")?.enable();const{customerName:n,contactNumber:s,customerId:m}=a;this.customerForm.patchValue({customerName:n,contactNumber:s,customerId:m})}}),this.service.setIsAddMoreItems(!1))})}isSelectedItem(e){return this.selectedEstimationItems.some(a=>a.itemCode===e.itemCode)}toggleSelection(e){const a=this.selectedEstimationItems.findIndex(n=>n.itemId===e.itemId);-1!==a?this.selectedEstimationItems.splice(a,1):e.availableQuantity>0&&(0==e.totalQuantity&&e.totalQuantity++,this.selectedEstimationItems.push(e)),this.service.addToCart(this.selectedEstimationItems)}validateQuantity(e){e.totalQuantity=Number(e.totalQuantity),isNaN(e.totalQuantity)&&(e.totalQuantity=0),e.totalQuantity>e.availableQuantity&&(e.totalQuantity=e.availableQuantity);const a=this.selectedEstimationItems.findIndex(n=>n.itemId===e.itemId);0==e.totalQuantity&&-1!==a?this.selectedEstimationItems.splice(a,1):e.totalQuantity>0&&-1===a?this.selectedEstimationItems.push(e):e.totalQuantity>0&&-1!==a&&(this.selectedEstimationItems[a]=e),this.service.addToCart(this.selectedEstimationItems)}incrementQuantity(e){if(e.availableQuantity>0&&e.totalQuantity<e.availableQuantity){e.totalQuantity++;const a=this.selectedEstimationItems.findIndex(n=>n.itemId===e.itemId);-1!==a?this.selectedEstimationItems[a].totalQuantity=e.totalQuantity:this.selectedEstimationItems.push(e),this.service.addToCart(this.selectedEstimationItems)}}decrementQuantity(e){if(e.totalQuantity>0){e.totalQuantity--;const a=this.selectedEstimationItems.findIndex(n=>n.itemId===e.itemId);0===e.totalQuantity&&-1!==a?this.selectedEstimationItems.splice(a,1):-1!==a&&(this.selectedEstimationItems[a].totalQuantity=e.totalQuantity),this.service.addToCart(this.selectedEstimationItems)}}createCustomerForm(){this.customerForm=this.fb.group({customerName:[{value:"",disabled:!0},[l.kI.required,l.kI.minLength(4)]],contactNumber:["",[l.kI.required,l.kI.pattern(/^[6-9]\d{9}$/)]],customerId:[""]})}onProductChange(e){this.getCategoryDetails(e.value)}onCategoryChange(e){this.getCategoryTypeDetails(e.value)}getProductDetails(){this.productService.getAllProducts().subscribe({next:e=>{this.productDetails=e}})}getCategoryDetails(e){this.categoryDetails=[],this.categoryTypeDetails=[],this.searchForm.get("categoryId")?.setValue(""),this.searchForm.get("categoryTypeId")?.setValue(""),this.categoryService.getAllCategories(e).subscribe({next:a=>{this.categoryDetails=a}})}getCategoryTypeDetails(e){this.categoryTypeDetails=[],this.searchForm.get("categoryTypeId")?.setValue(""),this.categoryTypeService.getAllQuality(e).subscribe({next:a=>{this.categoryTypeDetails=a}})}validateCartItems(){const e=this.selectedEstimationItems.some(a=>isNaN(Number(a.salePrice))||Number(a.salePrice)<1);return e&&this.snackBar.open(" Please check the sale Price of selected items","close",{duration:3e3}),!e}viewCart(){this.validateCartItems()?(this.service.setCustomerDetails(this.customerForm.value),this.router.navigate(["/dashboard/estimations/cart"])):this.isClicked=!0}moveToBilling(){this.validateCartItems()?(this.service.setCustomerDetails(this.customerForm.value),this.router.navigate(["/dashboard/estimations/billing"])):this.isClicked=!0}customerSelected(e){if("string"==typeof e)e.length>3&&this.service.searchCustomers({customerName:e}).subscribe(a=>{a&&(this.customersAutoOptions=a.map(n=>({id:n.customerId,name:n.customerName})),this.customersData=a)}),this.customerForm.get("customerName")?.setValue(e),this.customerForm.get("customerId")?.setValue("");else if("object"==typeof e&&e){const n=this.customersData.find(s=>s.customerId==e.id)?.contactNumber||"";this.customerForm.get("contactNumber")?.setValue(n),this.customerForm.get("customerName")?.setValue(e.name),this.customerForm.get("customerId")?.setValue(e.id)}else this.customerForm.get("customerId")?.setValue("")}hasError(e,a){return this.customerForm.get(e)?.hasError(a)}searchCustomerByNumber(){const e=this.customerForm.get("contactNumber")?.value,a=this.customerForm.get("customerName"),n=this.customerForm.get("customerId");10==e?.toString().length?this.service.searchCustomers({contactNumber:e.toString()}).subscribe(s=>{s&&s.length>0?(a?.setValue(s[0].customerName),a?.enable(),this.customerNameReadOnly=!0,n?.setValue(s[0].customerId)):(n?.setValue(""),a?.enable(),this.customerNameReadOnly=!1,a?.markAsTouched())}):(n?.setValue(""),a?.setValue(""),a?.disable(),this.customerNameReadOnly=!0)}isSearchDisabled(){if(!this.customerForm.valid)return!0;const{productId:a,categoryId:n,categoryTypeId:s}=this.searchForm.value;return!(a||n||s||this.itemNameOrCode)}searchProductItems(){this.isSpinnerLoading=!0;const{productId:e,categoryId:a,categoryTypeId:n}=this.searchForm.value;if(!(e||a||n||this.itemNameOrCode))return;const s={page:1,pageSize:20,sortBy:"itemName",sortDir:"ASC",itemNameOrCode:this.itemNameOrCode?this.itemNameOrCode:void 0,productId:e||void 0,categoryId:a||void 0,categoryTypeId:n||void 0};this.itemNameOrCode&&(s.productId=void 0,s.categoryId=void 0,s.categoryTypeId=void 0),this.service.searchProductItems(s).subscribe(m=>{m.data&&(this.isSpinnerLoading=!1,this.dataSource.data=m.data.map(C=>{const b=this.selectedEstimationItems.find(y=>y.itemCode==C.itemCode);return b&&(C.totalQuantity=b.totalQuantity),C}))})}formatSalePrice(e){const a=parseFloat(e.salePrice);e.salePrice=Number(a).toFixed(2);const n=this.selectedEstimationItems.find(s=>s.itemCode==e.itemCode);n&&(n.salePrice=e.salePrice)}emptyValue(e){e.target.value<1&&(e.target.value="")}static#t=this.\u0275fac=function(a){return new(a||i)(t.Y36(v),t.Y36(g.F0),t.Y36(l.qu),t.Y36(H.M),t.Y36(L.H),t.Y36(R._),t.Y36(A.ux))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-estimation-create"]],viewQuery:function(a,n){if(1&a&&t.Gf(_.NW,5),2&a){let s;t.iGM(s=t.CRH())&&(n.paginator=s.first)}},decls:85,vars:27,consts:[[1,"heading"],["routerLink","/dashboard/estimations",1,"back-key"],[1,"title"],[3,"formGroup"],["appearance","outline"],["type","number","matInput","","formControlName","contactNumber","required","",3,"input"],[4,"ngIf"],["appearance","outline",1,"ms-4"],["type","text","matInput","","formControlName","customerName","required","",3,"readonly"],[1,"selectToSearch",3,"formGroup"],["formControlName","productId",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["formControlName","categoryId",3,"selectionChange"],["formControlName","categoryTypeId"],["appearance","outline",1,"search","hide-search"],["matPrefix",""],["type","text","matInput","","placeholder","Search Item Name or Code",3,"ngModel","ngModelChange"],["matSuffix","","mat-icon-button","",3,"click",4,"ngIf"],["type","button","mat-raised-button","",1,"primary-button","searchButton",3,"disabled","click"],[4,"ngIf","ngIfElse"],["loadedContent",""],[1,"search-field"],["appearance","outline",1,"search","show-search"],[1,"btns"],["mat-raised-button","",1,"addToCart",3,"disabled","click"],["mat-raised-button","",1,"primary-button",3,"disabled","click"],[1,"div-scroll"],["mat-table","",1,"mat-elevation-z8","mat-table",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","itemName"],["matColumnDef","salePrice"],["mat-cell","","class","inputPrice",4,"matCellDef"],["matColumnDef","itemCode"],["matColumnDef","description"],["matColumnDef","quantity"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[4,"matNoDataRow"],["showFirstLastButtons","",3,"pageSizeOptions"],[3,"value"],["matSuffix","","mat-icon-button","",3,"click"],["mat-header-cell",""],["mat-cell",""],["color","primary",1,"checkBox",3,"checked","change"],[1,"image-container"],["alt","Image",3,"src"],[1,"image-details"],[1,"subHeading"],["mat-cell","",1,"inputPrice"],["appearance","outline","subscriptSizing","dynamic",1,"matInputField"],["type","number","matInput","","placeholder","0",3,"ngModel","ngModelChange","change","focus"],["class","price_error",4,"ngIf"],[1,"price_error"],[1,"description"],[1,"cartField"],["matPrefix","","mat-icon-button","",3,"disabled","click"],["matInput","","type","text",1,"cartInput",3,"ngModel","ngModelChange","keyup"],["matSuffix","","mat-icon-button","",3,"disabled","click"],[1,"mb-0"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],[1,"mat-cell"]],template:function(a,n){if(1&a&&(t.TgZ(0,"mat-card")(1,"mat-card-content")(2,"h1",0)(3,"mat-icon",1),t._uU(4," keyboard_backspace "),t.qZA(),t._uU(5,"Add Estimation "),t.qZA(),t.TgZ(6,"h2",2),t._uU(7,"Customer Details"),t.qZA(),t.TgZ(8,"div")(9,"form",3)(10,"mat-form-field",4)(11,"mat-label"),t._uU(12,"+91 "),t.qZA(),t.TgZ(13,"input",5),t.NdJ("input",function(){return n.searchCustomerByNumber()}),t.qZA(),t.YNc(14,K,2,0,"mat-error",6),t.YNc(15,X,2,0,"mat-error",6),t.qZA(),t.TgZ(16,"mat-form-field",7)(17,"mat-label"),t._uU(18,"Customer Name"),t.qZA(),t._UZ(19,"input",8),t.YNc(20,tt,2,0,"mat-error",6),t.YNc(21,et,2,0,"mat-error",6),t.qZA()()(),t.TgZ(22,"h2",2),t._uU(23,"Find Products"),t.qZA(),t.TgZ(24,"form",9)(25,"mat-form-field",4)(26,"mat-label"),t._uU(27,"Category Name"),t.qZA(),t.TgZ(28,"mat-select",10),t.NdJ("selectionChange",function(m){return n.onProductChange(m)}),t.YNc(29,it,2,2,"mat-option",11),t.qZA()(),t.TgZ(30,"mat-form-field",4)(31,"mat-label"),t._uU(32,"Product Name"),t.qZA(),t.TgZ(33,"mat-select",12),t.NdJ("selectionChange",function(m){return n.onCategoryChange(m)}),t.YNc(34,at,2,2,"mat-option",11),t.qZA()(),t.TgZ(35,"mat-form-field",4)(36,"mat-label"),t._uU(37,"Quality Name"),t.qZA(),t.TgZ(38,"mat-select",13),t.YNc(39,nt,2,2,"mat-option",11),t.qZA()(),t.TgZ(40,"mat-form-field",14)(41,"mat-icon",15),t._uU(42,"search"),t.qZA(),t.TgZ(43,"input",16),t.NdJ("ngModelChange",function(m){return n.itemNameOrCode=m}),t.qZA(),t.YNc(44,ot,3,0,"button",17),t.qZA(),t.TgZ(45,"button",18),t.NdJ("click",function(){return n.searchProductItems()}),t.YNc(46,st,2,0,"div",19),t.YNc(47,rt,1,0,"ng-template",null,20,t.W1O),t.qZA()(),t.TgZ(49,"div",21)(50,"mat-form-field",22)(51,"mat-icon",15),t._uU(52,"search"),t.qZA(),t.TgZ(53,"input",16),t.NdJ("ngModelChange",function(m){return n.itemNameOrCode=m}),t.qZA(),t.YNc(54,mt,3,0,"button",17),t.qZA(),t.TgZ(55,"div",23)(56,"button",24),t.NdJ("click",function(){return n.viewCart()}),t._uU(57),t.qZA(),t.TgZ(58,"button",25),t.NdJ("click",function(){return n.moveToBilling()}),t._uU(59,"Move to Billing"),t.qZA()()(),t.TgZ(60,"div",26)(61,"table",27),t.ynx(62,28),t.YNc(63,ct,2,0,"th",29),t.YNc(64,lt,2,1,"td",30),t.BQk(),t.ynx(65,31),t.YNc(66,dt,2,0,"th",29),t.YNc(67,ut,8,3,"td",30),t.BQk(),t.ynx(68,32),t.YNc(69,pt,2,0,"th",29),t.YNc(70,ht,6,2,"td",33),t.BQk(),t.ynx(71,34),t.YNc(72,_t,2,0,"th",29),t.YNc(73,ft,2,1,"td",30),t.BQk(),t.ynx(74,35),t.YNc(75,Ct,2,0,"th",29),t.YNc(76,bt,3,1,"td",30),t.BQk(),t.ynx(77,36),t.YNc(78,vt,2,0,"th",29),t.YNc(79,Tt,12,6,"td",30),t.BQk(),t.YNc(80,Zt,1,0,"tr",37),t.YNc(81,xt,1,0,"tr",38),t.YNc(82,yt,4,1,"ng-container",39),t.qZA()()(),t.TgZ(83,"mat-card-footer"),t._UZ(84,"mat-paginator",40),t.qZA()()),2&a){const s=t.MAs(48);t.xp6(9),t.Q6J("formGroup",n.customerForm),t.xp6(5),t.Q6J("ngIf",n.hasError("contactNumber","required")),t.xp6(1),t.Q6J("ngIf",n.hasError("contactNumber","pattern")),t.xp6(4),t.Q6J("readonly",n.customerNameReadOnly),t.xp6(1),t.Q6J("ngIf",n.hasError("customerName","required")),t.xp6(1),t.Q6J("ngIf",n.hasError("customerName","minlength")),t.xp6(3),t.Q6J("formGroup",n.searchForm),t.xp6(5),t.Q6J("ngForOf",n.productDetails),t.xp6(5),t.Q6J("ngForOf",n.categoryDetails),t.xp6(5),t.Q6J("ngForOf",n.categoryTypeDetails),t.xp6(4),t.Q6J("ngModel",n.itemNameOrCode),t.xp6(1),t.Q6J("ngIf",""!==n.itemNameOrCode),t.xp6(1),t.ekj("secondary-button",n.isSearchDisabled()),t.Q6J("disabled",n.isSearchDisabled()),t.xp6(1),t.Q6J("ngIf",n.isSpinnerLoading)("ngIfElse",s),t.xp6(7),t.Q6J("ngModel",n.itemNameOrCode),t.xp6(1),t.Q6J("ngIf",""!==n.itemNameOrCode),t.xp6(2),t.Q6J("disabled",!n.selectedEstimationItems.length),t.xp6(1),t.hij(" View Cart (",n.selectedEstimationItems.length,")"),t.xp6(1),t.Q6J("disabled",!n.selectedEstimationItems.length),t.xp6(3),t.Q6J("dataSource",n.dataSource),t.xp6(19),t.Q6J("matHeaderRowDef",n.displayColumns),t.xp6(1),t.Q6J("matRowDefColumns",n.displayColumns),t.xp6(3),t.Q6J("pageSizeOptions",t.DdM(26,It))}},dependencies:[u.sg,u.O5,g.rH,G.O,p.KE,p.hX,p.TO,p.qo,p.R9,x.Nt,d.a8,d.dn,d.rt,l._Y,l.Fj,l.wV,l.JJ,l.JL,l.Q7,l.On,l.sg,l.u,q.oG,f.lW,f.RK,r.BZ,r.fO,r.as,r.w1,r.Dz,r.nj,r.ge,r.ev,r.XQ,r.Gk,r.Ee,T.Hw,W.gD,V.ey,_.NW]})}return i})();function Nt(i,o){1&i&&(t.TgZ(0,"th",24),t._uU(1," Selected "),t.qZA())}function Dt(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"td",25)(1,"mat-checkbox",26),t.NdJ("change",function(){const s=t.CHM(e).$implicit,m=t.oxw();return t.KtG(m.toggleSelection(s))}),t.qZA()()}if(2&i){const e=o.$implicit,a=t.oxw();t.xp6(1),t.Q6J("checked",a.selectedEstimationItems.includes(e))}}function At(i,o){1&i&&(t.TgZ(0,"th",24),t._uU(1,"Item Name"),t.qZA())}function qt(i,o){if(1&i&&(t.TgZ(0,"td",25)(1,"div",27),t._UZ(2,"img",28),t.TgZ(3,"div",29)(4,"h3",2),t._uU(5),t.qZA(),t.TgZ(6,"p",30),t._uU(7),t.qZA()()()()),2&i){const e=o.$implicit,a=t.oxw();t.xp6(2),t.Q6J("src",e.image?a.baseURLImages+e.image:"../../../../assets/images/No_Image.jpg",t.LSH),t.xp6(3),t.Oqu(e.itemName),t.xp6(2),t.Oqu(e.companyName)}}function Ut(i,o){1&i&&(t.TgZ(0,"th",24),t._uU(1,"Sale Price"),t.qZA())}function Qt(i,o){if(1&i&&(t.TgZ(0,"td",25),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.hij(" ",e.salePrice," ")}}function wt(i,o){1&i&&(t.TgZ(0,"th",24),t._uU(1,"Item Code"),t.qZA())}function St(i,o){if(1&i&&(t.TgZ(0,"td",25),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.Oqu(e.itemCode)}}function kt(i,o){1&i&&(t.TgZ(0,"th",24),t._uU(1,"Description"),t.qZA())}function Ot(i,o){if(1&i&&(t.TgZ(0,"td",25)(1,"div",31),t._uU(2),t.qZA()()),2&i){const e=o.$implicit;t.xp6(2),t.Oqu(e.description)}}function Jt(i,o){1&i&&(t.TgZ(0,"th",24),t._uU(1,"Quantity"),t.qZA())}function Yt(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"td",25)(1,"div",32)(2,"mat-form-field",33)(3,"button",34),t.NdJ("click",function(){const s=t.CHM(e).$implicit,m=t.oxw();return t.KtG(m.decrementQuantity(s))}),t.TgZ(4,"mat-icon"),t._uU(5,"remove"),t.qZA()(),t.TgZ(6,"input",35),t.NdJ("ngModelChange",function(n){const m=t.CHM(e).$implicit;return t.KtG(m.totalQuantity=n)})("keyup",function(){const s=t.CHM(e).$implicit,m=t.oxw();return t.KtG(m.validateQuantity(s))}),t.qZA(),t.TgZ(7,"button",36),t.NdJ("click",function(){const s=t.CHM(e).$implicit,m=t.oxw();return t.KtG(m.incrementQuantity(s))}),t.TgZ(8,"mat-icon"),t._uU(9,"add"),t.qZA()()()(),t.TgZ(10,"p"),t._uU(11),t.qZA()()}if(2&i){const e=o.$implicit;t.xp6(3),t.Q6J("disabled",e.totalQuantity<1),t.xp6(3),t.Q6J("ngModel",e.totalQuantity),t.xp6(1),t.Q6J("disabled",e.totalQuantity>=e.availableQuantity),t.xp6(4),t.hij("Available : ",e.availableQuantity,"")}}function Mt(i,o){if(1&i&&(t.ynx(0),t.TgZ(1,"tr",37)(2,"td",38),t._uU(3," No data found "),t.qZA()(),t.BQk()),2&i){const e=t.oxw();t.xp6(2),t.uIk("colspan",e.displayColumns.length)}}function Ft(i,o){1&i&&t._UZ(0,"tr",39)}function Pt(i,o){1&i&&t._UZ(0,"tr",40)}const Bt=function(){return[10,20,50]};let $t=(()=>{class i{constructor(e,a){this.service=e,this.router=a,this.displayColumns=["select","itemName","itemCode","description","salePrice","quantity"],this.dataSource=new r.by([]),this.selectedEstimationItems=[],this.baseURLImages=h.$.api.baseUrl,this.customerName="",this.customerNumber=""}ngOnInit(){this.updateCartItemsIntoTable(),this.updateCustomerDetails()}ngAfterViewInit(){this.dataSource.paginator=this.paginator}updateCartItemsIntoTable(){this.service.selectedEstimationItems$.pipe((0,D.q)(1)).subscribe(e=>{e&&e.length>0?(this.dataSource.data=e,this.selectedEstimationItems=e):this.router.navigate(["/dashboard/estimations/addEstimation"])})}updateCustomerDetails(){this.service.customerDetails$.subscribe({next:e=>{e&&(this.customerName=e.customerName,this.customerNumber=e.contactNumber)}})}toggleSelection(e){const a=this.selectedEstimationItems.findIndex(n=>n.itemId===e.itemId);-1!==a?this.selectedEstimationItems.splice(a,1):e.availableQuantity>0&&(0==e.totalQuantity&&e.totalQuantity++,this.selectedEstimationItems.push(e)),this.service.addToCart(this.selectedEstimationItems)}validateQuantity(e){e.totalQuantity=Number(e.totalQuantity),isNaN(e.totalQuantity)&&(e.totalQuantity=0),e.totalQuantity>e.availableQuantity&&(e.totalQuantity=e.availableQuantity);const a=this.selectedEstimationItems.findIndex(n=>n.itemId===e.itemId);0==e.totalQuantity&&-1!==a?(this.selectedEstimationItems.splice(a,1),this.service.addToCart(this.selectedEstimationItems)):e.totalQuantity>0&&-1===a&&(this.selectedEstimationItems.push(e),this.service.addToCart(this.selectedEstimationItems))}incrementQuantity(e){e.availableQuantity>0&&e.totalQuantity<e.availableQuantity&&(0===e.totalQuantity&&this.selectedEstimationItems.push(e),e.totalQuantity++,this.service.addToCart(this.selectedEstimationItems))}decrementQuantity(e){if(e.totalQuantity>0){if(e.totalQuantity--,0===e.totalQuantity){const a=this.selectedEstimationItems.findIndex(n=>n.itemId===e.itemId);-1!==a&&this.selectedEstimationItems.splice(a,1)}this.service.addToCart(this.selectedEstimationItems)}}moveToBilling(){this.router.navigate(["/dashboard/estimations/billing"])}moveToAddEstimation(){this.service.setIsAddMoreItems(!0),this.router.navigate(["/dashboard/estimations/addEstimation"])}static#t=this.\u0275fac=function(a){return new(a||i)(t.Y36(v),t.Y36(g.F0))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-estimation-detail"]],viewQuery:function(a,n){if(1&a&&t.Gf(_.NW,5),2&a){let s;t.iGM(s=t.CRH())&&(n.paginator=s.first)}},decls:50,vars:8,consts:[[1,"heading"],["routerLink","/dashboard/estimations/addEstimation",1,"back-key"],[1,"title"],["appearance","outline"],["type","number","matInput","","readonly","",3,"value"],["appearance","outline",1,"ms-4"],["type","text","matInput","","readonly","",3,"value"],[1,"header"],["mat-raised-button","",1,"addToCart","btn","w-11rem",3,"click"],["mat-raised-button","",1,"primary-button","btn","w-11rem",3,"click"],[1,"div-scroll"],["mat-table","",1,"mat-table","mat-elevation-z8",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","itemName"],["matColumnDef","salePrice"],["matColumnDef","itemCode"],["matColumnDef","description"],["matColumnDef","quantity"],[4,"matNoDataRow"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSizeOptions"],["mat-header-cell",""],["mat-cell",""],["color","primary",3,"checked","change"],[1,"image-container"],["alt","Image",3,"src"],[1,"image-details"],[1,"subHeading"],[1,"description"],[1,"cartField"],["appearance","outline","subscriptSizing","dynamic",1,"matInputField"],["matPrefix","","mat-icon-button","",3,"disabled","click"],["matInput","","type","text",1,"cartInput",3,"ngModel","ngModelChange","keyup"],["matSuffix","","mat-icon-button","",3,"disabled","click"],[1,"mat-row"],[1,"mat-cell"],["mat-header-row",""],["mat-row",""]],template:function(a,n){1&a&&(t.TgZ(0,"mat-card")(1,"mat-card-content")(2,"h1",0)(3,"mat-icon",1),t._uU(4,"keyboard_backspace"),t.qZA(),t._uU(5,"Cart"),t.qZA(),t.TgZ(6,"h2",2),t._uU(7,"Customer details"),t.qZA(),t.TgZ(8,"div")(9,"mat-form-field",3)(10,"mat-label"),t._uU(11,"+91-"),t.qZA(),t._UZ(12,"input",4),t.qZA(),t.TgZ(13,"mat-form-field",5)(14,"mat-label"),t._uU(15,"Customer Name"),t.qZA(),t._UZ(16,"input",6),t.qZA()(),t.TgZ(17,"div",7)(18,"h2",2),t._uU(19),t.qZA(),t.TgZ(20,"div")(21,"button",8),t.NdJ("click",function(){return n.moveToAddEstimation()}),t._uU(22,"Add More to Cart"),t.qZA(),t.TgZ(23,"button",9),t.NdJ("click",function(){return n.moveToBilling()}),t._uU(24,"Move to Billing"),t.qZA()()(),t.TgZ(25,"div",10)(26,"table",11),t.ynx(27,12),t.YNc(28,Nt,2,0,"th",13),t.YNc(29,Dt,2,1,"td",14),t.BQk(),t.ynx(30,15),t.YNc(31,At,2,0,"th",13),t.YNc(32,qt,8,3,"td",14),t.BQk(),t.ynx(33,16),t.YNc(34,Ut,2,0,"th",13),t.YNc(35,Qt,2,1,"td",14),t.BQk(),t.ynx(36,17),t.YNc(37,wt,2,0,"th",13),t.YNc(38,St,2,1,"td",14),t.BQk(),t.ynx(39,18),t.YNc(40,kt,2,0,"th",13),t.YNc(41,Ot,3,1,"td",14),t.BQk(),t.ynx(42,19),t.YNc(43,Jt,2,0,"th",13),t.YNc(44,Yt,12,4,"td",14),t.BQk(),t.YNc(45,Mt,4,1,"ng-container",20),t.YNc(46,Ft,1,0,"tr",21),t.YNc(47,Pt,1,0,"tr",22),t.qZA()()(),t.TgZ(48,"mat-card-footer"),t._UZ(49,"mat-paginator",23),t.qZA()()),2&a&&(t.xp6(12),t.Q6J("value",n.customerNumber),t.xp6(4),t.Q6J("value",n.customerName),t.xp6(3),t.hij("Cart Items - ",n.selectedEstimationItems.length,""),t.xp6(7),t.Q6J("dataSource",n.dataSource),t.xp6(20),t.Q6J("matHeaderRowDef",n.displayColumns),t.xp6(1),t.Q6J("matRowDefColumns",n.displayColumns),t.xp6(2),t.Q6J("pageSizeOptions",t.DdM(7,Bt)))},dependencies:[g.rH,p.KE,p.hX,p.qo,p.R9,x.Nt,d.a8,d.dn,d.rt,l.Fj,l.JJ,l.On,q.oG,f.lW,f.RK,r.BZ,r.fO,r.as,r.w1,r.Dz,r.nj,r.ge,r.ev,r.XQ,r.Gk,r.Ee,T.Hw,_.NW]})}return i})();var jt=c(9692);function zt(i,o){if(1&i&&(t.TgZ(0,"div")(1,"h2",4),t._uU(2,"Billing To"),t.qZA(),t.TgZ(3,"h3",4),t._uU(4),t.qZA(),t.TgZ(5,"h4"),t._uU(6),t.qZA()()),2&i){const e=t.oxw();t.xp6(4),t.Oqu(e.customerDetails.customerName),t.xp6(2),t.Oqu(e.customerDetails.contactNumber)}}function Ht(i,o){if(1&i&&(t.TgZ(0,"div")(1,"h2",4),t._uU(2,"Billing from"),t.qZA(),t.TgZ(3,"h3",4),t._uU(4),t.qZA(),t.TgZ(5,"h4"),t._uU(6),t.qZA(),t.TgZ(7,"h4"),t._uU(8),t.qZA()()),2&i){const e=t.oxw();t.xp6(4),t.Oqu(e.organizationDetails.organizationName),t.xp6(2),t.Oqu(e.organizationDetails.address),t.xp6(2),t.Oqu(e.organizationDetails.contactNumber)}}function Lt(i,o){if(1&i&&(t.TgZ(0,"mat-header-cell",27),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit,a=t.oxw();t.xp6(1),t.Oqu(a.billingHeading[e])}}function Rt(i,o){if(1&i&&(t.ynx(0,32),t.TgZ(1,"div",33),t._UZ(2,"img",34),t.TgZ(3,"div",35)(4,"h3",4),t._uU(5),t.qZA(),t.TgZ(6,"h3",36),t._uU(7),t.qZA()()(),t.BQk()),2&i){const e=t.oxw().$implicit,a=t.oxw(2);t.xp6(2),t.Q6J("src",e.image?a.baseURLImages+e.image:"../../../../assets/images/No_Image.jpg",t.LSH),t.xp6(3),t.Oqu(e.itemName),t.xp6(2),t.hij(" ",e.companyName," ")}}function Gt(i,o){if(1&i&&(t.ynx(0),t.TgZ(1,"mat-icon",37),t._uU(2,"currency_rupee"),t.qZA(),t.TgZ(3,"span",38),t._uU(4),t.qZA(),t.BQk()),2&i){const e=t.oxw().$implicit;t.xp6(4),t.Oqu(e.totalQuantity*e.salePrice)}}function Wt(i,o){if(1&i&&(t.ynx(0),t.TgZ(1,"div"),t._uU(2),t.qZA(),t.BQk()),2&i){const e=t.oxw().$implicit;t.xp6(2),t.Oqu(e.totalQuantity)}}const Vt=function(i,o){return{description:i,subTitle:o}};function Kt(i,o){if(1&i&&(t.TgZ(0,"span",39),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit,a=t.oxw().$implicit;t.Q6J("ngClass",t.WLB(2,Vt,"description"===a,"salePrice"===a)),t.xp6(1),t.Oqu(e[a])}}function Xt(i,o){if(1&i&&(t.TgZ(0,"mat-cell",28),t.YNc(1,Rt,8,3,"ng-container",29),t.YNc(2,Gt,5,1,"ng-container",3),t.YNc(3,Wt,3,1,"ng-container",3),t.YNc(4,Kt,2,5,"ng-template",30,31,t.W1O),t.qZA()),2&i){const e=t.MAs(5),a=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf","itemName"===a)("ngIfElse",e),t.xp6(1),t.Q6J("ngIf","subAmount"===a),t.xp6(1),t.Q6J("ngIf","quantity"===a)}}function te(i,o){1&i&&(t.ynx(0,24),t.YNc(1,Lt,2,1,"mat-header-cell",25),t.YNc(2,Xt,6,4,"mat-cell",26),t.BQk()),2&i&&t.Q6J("matColumnDef",o.$implicit)}function ee(i,o){1&i&&(t.TgZ(0,"div",40)(1,"td",41),t._uU(2,"No data found"),t.qZA()())}function ie(i,o){1&i&&t._UZ(0,"mat-header-row")}function ae(i,o){1&i&&t._UZ(0,"mat-row")}function ne(i,o){1&i&&(t.TgZ(0,"th",42)(1,"h2"),t._uU(2,"Amount"),t.qZA()())}function oe(i,o){if(1&i&&(t.TgZ(0,"td",43),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.Oqu(e.label)}}function se(i,o){1&i&&t._UZ(0,"th",42)}function re(i,o){if(1&i&&(t.TgZ(0,"td",43),t.ynx(1),t._uU(2),t.BQk(),t.qZA()),2&i){const e=o.$implicit;t.xp6(2),t.hij(" ",e.value," ")}}function me(i,o){1&i&&(t.TgZ(0,"div",40)(1,"td",41),t._uU(2,"No data found"),t.qZA()())}function ce(i,o){1&i&&t._UZ(0,"tr",44)}function le(i,o){1&i&&t._UZ(0,"tr",45)}const de=function(){return[5,10,20]};let ue=(()=>{class i{constructor(e,a,n,s){this.router=e,this.service=a,this.snackBar=n,this.authService=s,this.displayColumns=["itemName","itemCode","description","quantity","salePrice","subAmount"],this.datasource=new r.by([]),this.baseURLImages=h.$.api.baseUrl,this.billingHeading=E.x,this.paymentModes=[],this.selectedPaymentMode="",this.saleCalculation={subTotal:0,totalAmount:0},this.calculationdDataSource=[],this.calculationColumns=["label","value"],this.keyLabels={subTotal:"Sub Total",totalAmount:"Total Amount"},this.billingDetails={orderDate:new Date,totalWeight:0}}ngOnInit(){this.getSelectedEstimationItems(),this.getPaymentModes(),this.updateBillingDetails(),this.getUserWithOrganization()}getSelectedEstimationItems(){this.service.selectedEstimationItems$.subscribe(e=>{e&&e.length?(this.datasource.data=e,e.forEach(a=>{this.saleCalculation.subTotal+=a.totalQuantity*Number(a.salePrice)}),this.calculate()):this.router.navigate(["/dashboard/estimations/addEstimation"])})}calculate(){this.saleCalculation.totalAmount=this.saleCalculation.subTotal,this.calculationdDataSource=Object.entries(this.saleCalculation).map(([e,a])=>({key:e,label:this.keyLabels[e],value:a}))}updateBillingDetails(){this.service.customerDetails$.subscribe(e=>{e?this.customerDetails=e:this.router.navigate(["/dashboard/estimations/addEstimation"])}),this.billingDetails.totalWeight=this.datasource.data.reduce((e,a)=>e+Number(a.itemWeight*a.totalQuantity),0)}ngAfterViewInit(){this.datasource.paginator=this.paginator}moveToInvoice(){this.router.navigate(["/dashboard/estimation/invoice"])}getPaymentModes(){this.service.getSaleType().subscribe({next:e=>{this.paymentModes=e}})}getUserWithOrganization(){const e=this.authService.getLoggedInUserId();this.authService.getUserWithOrganizationById(e).subscribe({next:a=>{this.organizationDetails=a.organization},error:a=>{console.log(a)}})}onCreateEstimation(){const{customerId:e,customerName:a,contactNumber:n,gstNo:s,email:m,address:C}=this.customerDetails;if(e)this.createEstimation();else{const b={customerName:a,contactNumber:n.toString(),customerType:"B2B",gstNo:s,email:m,address:C};this.service.createCustomer(b).subscribe({next:y=>{this.customerDetails.customerId=y.customerId,this.createEstimation()},error:()=>{this.snackBar.open("Failed to create customer.","Close",{duration:5e3})}})}}createEstimation(){const e=this.authService.getLoggedInUserId();this.service.createEstimation({selectedItems:this.datasource.data,calculation:this.saleCalculation,weight:this.billingDetails.totalWeight,customerId:this.customerDetails.customerId,userId:e}).subscribe({next:n=>{this.snackBar.open("Estimation has been created successfully.","Close",{duration:5e3}),this.service.addToCart([]),this.service.setCustomerDetails(null),this.router.navigate(["/dashboard/estimations/invoice"],{queryParams:{invoiceId:n.invoiceId}})},error:n=>{console.log(n),this.snackBar.open("Failed to create Estimation.","Close",{duration:5e3})}})}static#t=this.\u0275fac=function(a){return new(a||i)(t.Y36(g.F0),t.Y36(v),t.Y36(A.ux),t.Y36(jt.e))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-estimation-edit"]],viewQuery:function(a,n){if(1&a&&t.Gf(_.NW,5),2&a){let s;t.iGM(s=t.CRH())&&(n.paginator=s.first)}},decls:44,vars:19,consts:[[1,"heading"],["routerLink","/dashboard/estimations/cart",1,"back-key"],[1,"order-details"],[4,"ngIf"],[1,"title"],[1,"div-scroll"],[1,"mat-table",3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],["class","d-flex justify-content-center",4,"matNoDataRow"],[4,"matHeaderRowDef","matHeaderRowDefSticky"],[4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSizeOptions"],[1,"billingDetails"],[1,"billingAmount"],["mat-table","",3,"dataSource"],["matColumnDef","label"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","value"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"buttons"],["mat-raised-button","","routerLink","/dashboard/estimations/addEstimation"],["mat-raised-button","",1,"primary-button",3,"disabled","click"],[3,"matColumnDef"],["class","mat-table-head",4,"matHeaderCellDef"],["class","mat-table-cell",4,"matCellDef"],[1,"mat-table-head"],[1,"mat-table-cell"],["class","img-col",4,"ngIf","ngIfElse"],["class","tabelData"],["nonImageColumn",""],[1,"img-col"],[1,"image-container"],["alt","Image",3,"src"],[1,"image-details"],[1,"subHeading"],[1,"priceIcon"],[1,"subTitle"],[3,"ngClass"],[1,"d-flex","justify-content-center"],[1,"mat-cell"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""]],template:function(a,n){1&a&&(t.TgZ(0,"mat-card")(1,"mat-card-content")(2,"h1",0)(3,"mat-icon",1),t._uU(4," keyboard_backspace "),t.qZA(),t._uU(5,"Billing "),t.qZA(),t.TgZ(6,"div",2),t.YNc(7,zt,7,2,"div",3),t.YNc(8,Ht,9,3,"div",3),t.TgZ(9,"div")(10,"h2",4),t._uU(11,"Order Date"),t.qZA(),t.TgZ(12,"h3"),t._uU(13),t.ALo(14,"date"),t.qZA()(),t.TgZ(15,"div")(16,"h2",4),t._uU(17,"Total Weight"),t.qZA(),t.TgZ(18,"h3"),t._uU(19),t.qZA()()(),t.TgZ(20,"div",5)(21,"mat-table",6),t.YNc(22,te,3,1,"ng-container",7),t.YNc(23,ee,3,0,"div",8),t.YNc(24,ie,1,0,"mat-header-row",9),t.YNc(25,ae,1,0,"mat-row",10),t.qZA()(),t._UZ(26,"mat-paginator",11),t.TgZ(27,"div",12)(28,"div",13)(29,"table",14),t.ynx(30,15),t.YNc(31,ne,3,0,"th",16),t.YNc(32,oe,2,1,"td",17),t.BQk(),t.ynx(33,18),t.YNc(34,se,1,0,"th",16),t.YNc(35,re,3,1,"td",17),t.BQk(),t.YNc(36,me,3,0,"div",8),t.YNc(37,ce,1,0,"tr",19),t.YNc(38,le,1,0,"tr",20),t.qZA()()(),t.TgZ(39,"div",21)(40,"button",22),t._uU(41,"Cancel"),t.qZA(),t.TgZ(42,"button",23),t.NdJ("click",function(){return n.onCreateEstimation()}),t._uU(43,"Save"),t.qZA()()()()),2&a&&(t.xp6(7),t.Q6J("ngIf",n.customerDetails),t.xp6(1),t.Q6J("ngIf",n.organizationDetails),t.xp6(5),t.Oqu(t.xi3(14,15,n.billingDetails.orderDate,"dd/MM/yyy")),t.xp6(6),t.hij("",n.billingDetails.totalWeight," Kgs"),t.xp6(2),t.Q6J("dataSource",n.datasource),t.xp6(1),t.Q6J("ngForOf",n.displayColumns),t.xp6(2),t.Q6J("matHeaderRowDef",n.displayColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",n.displayColumns),t.xp6(1),t.Q6J("pageSizeOptions",t.DdM(18,de)),t.xp6(3),t.Q6J("dataSource",n.calculationdDataSource),t.xp6(8),t.Q6J("matHeaderRowDef",n.calculationColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",n.calculationColumns),t.xp6(4),t.Q6J("disabled",n.saleCalculation.subTotal<1))},dependencies:[u.mk,u.sg,u.O5,g.rH,d.a8,d.dn,f.lW,r.BZ,r.fO,r.as,r.w1,r.Dz,r.nj,r.ge,r.ev,r.XQ,r.Gk,r.Ee,T.Hw,_.NW,u.uU],styles:[".billingAmount[_ngcontent-%COMP%]{width:40%;align-self:flex-end}.billingAmount[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:0}"]})}return i})();var pe=c(2983),ge=c(1477),he=c(2893),_e=c(7700);const fe=["invoiceContent"];function Ce(i,o){if(1&i&&(t.TgZ(0,"div")(1,"h3"),t._uU(2," Billed To : "),t.TgZ(3,"span",13),t._uU(4),t.qZA()(),t.TgZ(5,"p"),t._uU(6," Email: "),t.TgZ(7,"span"),t._uU(8),t.qZA()(),t.TgZ(9,"p"),t._uU(10," Phone: "),t.TgZ(11,"span"),t._uU(12),t.qZA()()()),2&i){const e=t.oxw(2);t.xp6(4),t.Oqu(e.invoiceDetails.customer.customerName),t.xp6(4),t.Oqu(e.invoiceDetails.customer.email),t.xp6(4),t.Oqu(e.invoiceDetails.customer.contactNumber)}}function be(i,o){if(1&i&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.categoryTypeInfo.categoryTypeName," ")}}function ve(i,o){if(1&i&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.YNc(5,be,2,1,"td",21),t.TgZ(6,"td"),t._uU(7),t.qZA(),t.TgZ(8,"td",26),t._uU(9),t.qZA(),t.TgZ(10,"td",26),t._uU(11),t.ALo(12,"number"),t.qZA(),t.TgZ(13,"td",26),t._uU(14),t.ALo(15,"number"),t.qZA()()),2&i){const e=o.$implicit,a=o.index,n=t.oxw(2);t.xp6(2),t.Oqu(a+1),t.xp6(2),t.Oqu(e.itemName),t.xp6(1),t.Q6J("ngIf",e.categoryTypeInfo),t.xp6(2),t.Oqu(e.totalQuantity),t.xp6(2),t.Oqu(n.unitsMap[e.unitId]),t.xp6(2),t.hij(" ",t.lcZ(12,7,e.salePrice)," "),t.xp6(3),t.hij(" ",t.lcZ(15,9,n.gettotalAmount(e))," ")}}function Te(i,o){if(1&i&&(t.TgZ(0,"div",5,6),t._UZ(2,"iframe",7),t.TgZ(3,"div",8)(4,"div",9)(5,"div",10)(6,"h3",11),t._uU(7,"GST NO"),t.qZA(),t.TgZ(8,"h3",12),t._uU(9,":"),t.qZA(),t.TgZ(10,"h3",13),t._uU(11),t.qZA()(),t.TgZ(12,"div",14)(13,"h3",15),t._uU(14,"Invoice No"),t.qZA(),t.TgZ(15,"h3",12),t._uU(16,":"),t.qZA(),t.TgZ(17,"h3",16),t._uU(18),t.qZA()()(),t.TgZ(19,"div",9)(20,"div",10)(21,"h3",11),t._uU(22,"Cell No"),t.qZA(),t.TgZ(23,"h3",12),t._uU(24,":"),t.qZA(),t.TgZ(25,"h3",13),t._uU(26),t.qZA()(),t.TgZ(27,"div",14)(28,"h3",15),t._uU(29,"Invoice Date"),t.qZA(),t.TgZ(30,"h3",12),t._uU(31,":"),t.qZA(),t.TgZ(32,"h3",16),t._uU(33),t.ALo(34,"dateStrFormat"),t.qZA()()(),t.TgZ(35,"div",17),t._UZ(36,"img",18),t.TgZ(37,"div")(38,"h2",19),t._uU(39),t.qZA(),t.TgZ(40,"h1"),t._uU(41,"Estimation-Invoice"),t.qZA()()(),t.TgZ(42,"div",20)(43,"div")(44,"h3"),t._uU(45," Billed By : "),t.TgZ(46,"span",13),t._uU(47),t.qZA()(),t.TgZ(48,"p"),t._uU(49," Phone: "),t.TgZ(50,"span"),t._uU(51),t.qZA()(),t.TgZ(52,"p"),t._uU(53," Email: "),t.TgZ(54,"span"),t._uU(55),t.qZA()()(),t.YNc(56,Ce,13,3,"div",21),t.qZA(),t.TgZ(57,"div",22)(58,"table",23)(59,"thead")(60,"tr")(61,"th"),t._uU(62,"#"),t.qZA(),t.TgZ(63,"th"),t._uU(64,"Item Name"),t.qZA(),t.TgZ(65,"th"),t._uU(66,"Brand/Quality"),t.qZA(),t.TgZ(67,"th"),t._uU(68,"Quantity"),t.qZA(),t.TgZ(69,"th"),t._uU(70,"Unit"),t.qZA(),t.TgZ(71,"th"),t._uU(72,"Price"),t.qZA(),t.TgZ(73,"th"),t._uU(74,"Amount"),t.qZA()()(),t.TgZ(75,"tbody"),t.YNc(76,ve,16,11,"tr",24),t.qZA(),t.TgZ(77,"tfoot")(78,"tr")(79,"td",25),t._uU(80,"Total"),t.qZA(),t.TgZ(81,"td",26)(82,"span",27),t._uU(83," \u20b9 "),t.qZA(),t._uU(84),t.ALo(85,"number"),t.qZA()()()(),t.TgZ(86,"div",28)(87,"div",29)(88,"table",30)(89,"tbody")(90,"tr")(91,"td"),t._uU(92,"Sub Total"),t.qZA(),t.TgZ(93,"td"),t._uU(94),t.ALo(95,"number"),t.qZA()(),t.TgZ(96,"tr",31)(97,"td"),t._uU(98,"Total"),t.qZA(),t.TgZ(99,"td"),t._uU(100),t.ALo(101,"number"),t.qZA()()()(),t.TgZ(102,"div",32)(103,"span",33),t._uU(104,"Amount (in words): "),t.qZA(),t.TgZ(105,"p"),t._uU(106),t.qZA()(),t.TgZ(107,"div",34)(108,"h4",35),t._uU(109),t.qZA(),t.TgZ(110,"h3",36),t._uU(111,"Authorized Signatory"),t.qZA()()()()(),t.TgZ(112,"div",37)(113,"h4",13),t._uU(114,"TERMS AND CONDITIONS"),t.qZA(),t.TgZ(115,"ul")(116,"li"),t._uU(117,"Good once sold will not be taken back or exchanged."),t.qZA(),t.TgZ(118,"li"),t._uU(119,"Subject to local jurisdiction only"),t.qZA(),t.TgZ(120,"li"),t._uU(121,"NO CLAIM SHALL BE ENTERTAINED AFTERLAYING THE TILES"),t.qZA(),t.TgZ(122,"li"),t._uU(123," Returns of goods will be accepted within 7 days from the date of purchase. "),t.qZA()()()()()),2&i){const e=t.oxw();t.xp6(11),t.hij(" ",e.invoiceDetails.user.organization.gstNo||"36XXXXX0000X1ZX"," "),t.xp6(7),t.Oqu(e.invoiceId),t.xp6(8),t.hij(" ",e.invoiceDetails.user.organization.contactNumber," "),t.xp6(7),t.hij(" ",t.lcZ(34,16,e.invoiceDetails.estimationDate)," "),t.xp6(3),t.Q6J("src",e.invoiceDetails.user.organization.image?e.baseURLImages+e.invoiceDetails.user.organization.image:"../../../../assets/images/logo.jpg",t.LSH),t.xp6(3),t.hij(" ",e.invoiceDetails.user.organization.organizationName," "),t.xp6(8),t.hij(" ",e.invoiceDetails.user.organization.organizationName," "),t.xp6(4),t.Oqu(e.invoiceDetails.user.organization.contactNumber),t.xp6(4),t.Oqu(e.invoiceDetails.user.email),t.xp6(1),t.Q6J("ngIf",e.invoiceDetails.customer),t.xp6(20),t.Q6J("ngForOf",e.estimationItems),t.xp6(8),t.hij(" ",t.lcZ(85,18,e.invoiceDetails.subTotal)," "),t.xp6(10),t.Oqu(t.lcZ(95,20,e.invoiceDetails.subTotal)),t.xp6(6),t.Oqu(t.lcZ(101,22,e.invoiceDetails.subTotal)),t.xp6(6),t.hij("( ",e.getTotalInWords(e.invoiceDetails.subTotal)," )"),t.xp6(3),t.hij(" For: ",e.invoiceDetails.user.organization.organizationName," ")}}const Ze=[{path:"",component:z},{path:"addEstimation",component:Et},{path:"cart",component:$t},{path:"billing",component:ue},{path:"invoice",component:(()=>{class i{constructor(e,a,n,s,m){this.service=e,this.route=a,this.router=n,this.commonService=s,this.dialog=m,this.unitsMap={},this.invoiceId="",this.baseURLImages=h.$.api.baseUrl}ngOnInit(){this.getEstimationInvoice(),this.getInvoiceData(),this.getAllUnits()}getEstimationInvoice(){this.route.queryParams.subscribe(e=>{this.invoiceId=e.invoiceId})}getInvoiceData(){this.invoiceId?this.service.getSaleInvoice(this.invoiceId).subscribe(e=>{this.invoiceDetails=e,this.estimationItems=e.estimationItems.map(a=>(a.item.totalQuantity=a.quantity,a.item.salePrice=a.salePrice,a.item))}):this.router.navigate(["/dashboard/estimations"])}getAllUnits(){this.commonService.getAllUnit().subscribe(e=>{e&&(this.unitsMap=e.reduce((a,n)=>(a[n.unitId]=n.unitShortName,a),{}))})}gettotalAmount(e){return e.totalQuantity*Number(e.salePrice)}downloadPdf(){this.commonService.generateAndSavePdf(this.invoiceContent.nativeElement,`Invoice_${this.invoiceDetails.invoiceId}.pdf`)}printInvoice(){const a=document.getElementById("previewFrame"),n=a.contentDocument||a.contentWindow.document;n.open(),n.write(`\n<!DOCTYPE html>\n<head>\n<style>\n@import"https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap";.mat-ripple {\noverflow: hidden;\nposition: relative\n}\n@page {\n        size: A4;\n        margin: 0;\n    }\n@media print {\nprint-area *{ /* can be whatever CSS selector you need */\n    transform: scale(x)\n}\n}\n\nhtml,body {\nheight: 100%;\nfont-family: Montserrat,sans-serif\n}\nbody {\nmargin: 0\n}\n\n.primary-color {\ncolor: #fff;\nbackground-color: #4985e5\n}\n.div-scroll {\noverflow-x: auto\n}\n.subHeading {\ncolor: #637381;\nfont-weight: 600;\nfont-size: 14px\n}\n.title {\nfont-weight: 500!important;\ncolor: #1f2937;\nfont-size: 18px\n}\n.subTitle {\ncolor: #637381;\nfont-size: 16px;\nfont-weight: 500\n}\n.header {\ndisplay: flex;\njustify-content: space-between;\nalign-items: center;\npadding: 1rem\n}\n.header h1,.header h2 {\nmargin-bottom: 0\n}\n.card-header {\ndisplay: flex;\njustify-content: space-between;\nalign-items: center;\npadding: 1rem\n}\n.mat-table {\nmargin-top: 1rem\n}\n.mat-table .mat-table-head,.mat-table th,.mat-table mat-header-cell {\njustify-content: center;\npadding: 0;\nbackground-color: #f6fafe!important\n}\n.mat-table .mat-table-cell:first-of-type {\njustify-content: flex-start\n}\n.mat-table .mat-table-cell:last-child p,.mat-table td:last-child p {\nmargin-bottom: 0\n}\n.mat-table .mat-table-cell,.mat-table .mat-mdc-cell,.mat-table td {\ntext-align: center;\npadding: .5rem 0px;\njustify-content: center\n}\n.mat-table .mat-table-cell .description,.mat-table .mat-mdc-cell .description,.mat-table td .description {\nbackground-color: #e5fcfc;\nborder-radius: .5rem;\npadding: 1rem;\ncolor: #637381;\nwidth: 100%\n}\n.mat-table .mat-table-cell .priceIcon,.mat-table .mat-mdc-cell .priceIcon,.mat-table td .priceIcon {\nfont-size: medium;\nheight: auto;\nwidth: auto;\ncolor: #637381\n}\n.mat-table .mat-table-cell .priceIcon2,.mat-table .mat-mdc-cell .priceIcon2,.mat-table td .priceIcon2 {\nfont-size: medium;\nheight: auto;\nwidth: auto;\nposition: relative;\ntop: .2rem\n}\n.mat-table td,.mat-table th {\ntext-align: center\n}\n.mat-table .align_Start {\nwidth: 6rem;\ndisplay: flex;\npadding-left: 1rem;\njustify-content: flex-start\n}\n.invoice-container {\nmargin: 1rem auto;\npadding: 1cm;\nbackground-color: #fff;\nbox-shadow: 0 0 10px #0000001a;\nwidth: 21cm\n}\n.invoiceData {\npadding: 0px,.5cm;\nwidth: 19cm;\ndisplay: flex;\nflex-direction: column;\nmargin: 0 auto\n}\n.invoiceData .header {\npadding: 0rem;\n}\n.invoiceData .header {\n  margin-top: 8px;\n }\n.invoiceData .header h3 {\nmargin-bottom: 0;\nline-height: 1.3rem\n}\n.invoiceData .header .header-1 {\ndisplay: flex\n}\n.invoiceData .header .header-1 .start {\nmin-width: 5rem;\ntext-align: start\n}\n.invoiceData .header .header-1 .middle {\nmax-width: 2rem;\ntext-align: center;\nmargin-right: 1rem\n}\n.invoiceData .header .header-2 {\ndisplay: flex;\nmax-width: 250px;\nmin-width: 250px;\njustify-content: end\n}\n.invoiceData .header .header-2 .start {\nmin-width: 7rem;\ntext-align: start\nmargin-botton:\n}\n.invoiceData .header .header-2 .middle {\nmax-width: 1rem;\ntext-align: center\n}\n.invoiceData .header .header-2 .end {\nmax-width: 6.5rem;\ntext-align: end!important;\nflex-grow: 1\n}\n.invoiceData .main {\ndisplay: flex;\nmargin-top: .5rem\n}\n.invoiceData .main img {\nheight: 80px;\nwidth: 80px\n}\n.invoiceData .main div {\nflex: 1;\ndisplay: flex;\nflex-direction: column;\nalign-items: center;\njustify-content: center;\npadding-right: 80px\n}\n.invoiceData .main div h1,.invoiceData .main div h2 {\nmargin-bottom: 0\n}\n.invoiceData .main div .type {\ncolor: #1f2937;\nfont-weight: 500;\nfont-size: 1.3rem;\nposition: relative;\nright: 7%\n}\n.invoiceData .header h3 {\n  margin: 0rem;\n  line-height: 1.3rem;\n}\n.invoiceData .main h2 {\n  margin: 0rem;\n}\n.invoiceData h4 {\nmargin-bottom: 0rem;\nline-height: 1.3rem\n}\n.invoiceData h1 {\nalign-self: center;\npadding: 0;\nmargin: 0\n}\n.invoiceData .company {\nfont-weight: 600;\ntext-align: center;\nmargin-bottom: 0;\nfont-size: 1.7rem\n}\n.invoiceData .billed {\ndisplay: flex;\ngap: 1rem;\nmargin-top: .5rem\n}\n.invoiceData .billed h3 {\nfont-weight: 500;\ncolor: #4985e5;\nmargin-bottom: .7rem\n}\n.invoiceData .billed h3 span {\nmargin-left: .5rem;\nfont-size: 1em\n}\n.invoiceData .billed div {\nflex: 1;\nborder: 1px solid #F3F4F6;\nbackground-color: #f6fafe;\nborder-radius: 10px;\npadding: .5rem 1rem .2rem;\nmin-height: 5rem\n}\n.invoiceData .billed p {\nmargin-bottom: 0.3rem;\nline-height: 1rem\n}\n.invoiceData .billed p span {\nfont-weight: 500\n}\n.invoiceData .header h3 {\n  margin-bottom: 0px !important;\n  line-height: 1.3rem !important;\n}\n.invoiceData thead {\nbackground-color: #4985e5;\ncolor: #fff;\nfont-size: .8rem\n}\n.invoiceData thead th {\npadding: 0.5rem\n}\n.invoiceData td {\nfont-size: .9rem;\npadding: 0rem 1rem;\nfont-weight: 500;\ntext-align: center\n}\n.invoiceData .total {\ndisplay: flex;\nflex-direction: row;\njustify-content: end;\nmargin-top: 1rem\n}\n.invoiceData .total .billing {\nmax-width: 50%\n}\n\n.invoiceData .total .totalInwords {\nmargin-top: .5rem;\ntext-wrap: wrap;\npadding: 0.5rem 1rem;\nfont-size: 11px;\nfont-weight: 500\n}\n.invoiceData .total .totalInwords .amountTitle {\nfont-weight: 500;\nfont-size: 15px;\nmargin-right: .5rem\n}\n.invoiceData .paymentype td {\ntext-align: start;\npadding: 0 0 0.5rem 1rem\n}\n.invoiceData mat-icon {\nfont-size: medium;\nposition: relative;\ntop: .7rem;\nleft: .2rem\n}\n.invoiceData .value {\ncolor: #4985e5\n}\n.invoiceData .itemsTable {\nmargin-top: 1rem;\nwidth: 100%\n}\n.invoiceData .itemsTable tbody td {\nwidth: 14.2857142857%;\ntext-wrap: nowrap;\npadding: 0.5rem;\n}\n.invoiceData .itemsTable tbody td:nth-last-child(2) {\ntext-align: start;\npadding-left: 2rem\n}\n.invoiceData .itemsTable tbody td:last-child {\ntext-align: end;\npadding: 0 1.5rem 0 0;\n}\n\n.invoiceData .itemsTable tfoot td {\n  border-top: 1px solid rgb(230, 217, 217);\n  border-bottom: 1px solid rgb(230, 217, 217);\n  font-weight: 700;\n  padding: 0.5rem;\n}\n.invoiceData .itemsTable tfoot td:first-child {\ntext-align: end;\npadding-right: 12.5rem\n}\n.invoiceData .itemsTable tfoot td:last-child {\ntext-align: end;\npadding: 0 1.4rem 0 0\n}\n.invoiceData .itemsTable tfoot td:last-child span {\nposition: relative;\nbottom: 4px\n}\n.invoiceData .subTotal {\nfont-weight: 500;\nline-height: 1.5rem;\nwidth: 100%\n}\n.invoiceData .subTotal tbody tr td:first-child {\n    padding-right: 3rem;\n    text-align: start;\n    text-wrap: nowrap;\n}\n.invoiceData .subTotal tbody tr td:last-child {\ntext-align: end;\npadding: 0.3rem 1.5rem 0.3rem 1rem;\nmin-width: 5rem\n}\n.invoiceData .salesSubtotal tr td:first-child {\npadding-right: 3rem;\ntext-align: start\ntext-wrap: no-wrap\n}\n.invoiceData .total_amount {\nbackground-color: #4985e5;\ncolor: #fff\n}\n.invoiceData .stamp {\nmargin-top: 5rem;\ntext-align: center\n}\n.invoiceData .footer ul {\npadding-left: 1rem\n}\n.invoiceData .footer ul li {\nmargin-bottom: 0.5rem\n}\n.invoiceData .min-Height {\nmin-height: 16cm\n}\n\n.invoiceData .header h3 {\n  margin-bottom: 0px;\n  line-height: 1.3rem;\n}\n.price-icon {\n  font-size: medium;\n  position: relative;\n  top: 1px;\n}\n.btn {\nheight: 3.2rem!important\n}\n.paidAmount {\nfont-weight: 700\n}\n.text-White {\ncolor: #fff\n}\n.bg-primary {\nbackground-color: #4985e5\n}\n.d-flex {\ndisplay: flex\n}\n.justify-content-center {\njustify-content: center\n}\n.align-items-center {\nalign-items: center\n}\n.m-0 {\nmargin: 0!important\n}\n.m-1 {\nmargin: .25rem\n}\n.m-2 {\nmargin: .5rem\n}\n.m-3 {\nmargin: 1rem\n}\n.mt-1 {\nmargin-top: .25rem\n}\n.mt-2 {\nmargin-top: .5rem\n}\n.mt-3 {\nmargin-top: 1rem\n}\n.mb-0 {\nmargin-bottom: 0rem!important\n}\n.mb-1 {\nmargin-bottom: .25rem!important\n}\n.mb-2 {\nmargin-bottom: .5rem\n}\n.mb-3 {\nmargin-bottom: 1rem\n}\n.me-1 {\nmargin-right: .25rem\n}\n.me-2 {\nmargin-right: .5rem\n}\n.me-3 {\nmargin-right: 1rem\n}\n.ms-4 {\nmargin-left: 2rem\n}\n.ps-3 {\npadding-left: 1rem\n}\n.p-0 {\npadding: 0!important\n}\n.p-1 {\npadding: .25rem\n}\n.p-2 {\npadding: .5rem\n}\n.p-3 {\npadding: 1rem\n}\n.pt-0 {\npadding-top: 0rem\n}\n.pt-1 {\npadding-top: .25rem\n}\n.pt-2 {\npadding-top: .5rem!important\n}\n.pt-3 {\npadding-top: 1rem\n}\n.pb-1 {\npadding-bottom: .25rem\n}\n.pb-2 {\npadding-bottom: .5rem\n}\n.pb-3 {\npadding-bottom: 1rem!important\n}\n.ps-5 {\npadding-left: 2.5rem\n}\n.text-left {\ntext-align: left\n}\n.text-center {\ntext-align: center!important\n}\n.text-right {\ntext-align: right\n}\n.text-nowrap {\ntext-wrap: nowrap\n}\n\n::deep {\nfont-family: Montserrat;\nfont-size: medium;\nfont-weight: 600\n}\n}\n@page {\n  size: A4;\n  margin: 0;\n}\n@media print {\n print-area *{ /* can be whatever CSS selector you need */\n   transform: scale(x)\n }\n}\n</style>\n</head>\n<body>\n${this.invoiceContent.nativeElement.innerHTML}\n</body>\n</html>\n`),n.close(),a.onload=function(){a.contentWindow.print()}}convertToSale(){this.router.navigate(["dashboard/sales/billing"],{queryParams:{invoiceId:this.invoiceDetails.invoiceId}})}openConvertConfirmDialog(){this.dialog.open(pe.h,{width:"600px",data:{title:"Confirm to Convert",content:"Are you sure, Want to Convert Estimation to Sale ?"}}).afterClosed().subscribe(a=>{a&&this.convertToSale()})}getTotalInWords(e){const a=Number(e);return this.commonService.convertNumberToWords(a)}static#t=this.\u0275fac=function(a){return new(a||i)(t.Y36(ge.M),t.Y36(g.gz),t.Y36(g.F0),t.Y36(he.v),t.Y36(_e.uw))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-estimation-invoice"]],viewQuery:function(a,n){if(1&a&&t.Gf(fe,5),2&a){let s;t.iGM(s=t.CRH())&&(n.invoiceContent=s.first)}},decls:14,vars:1,consts:[[1,"heading"],[1,"d-flex"],["mat-raised-button","",1,"primary-button",3,"click"],[1,"div-scroll"],["class","invoice-container",4,"ngIf"],[1,"invoice-container"],["invoiceContent",""],["id","previewFrame",2,"display","none"],[1,"invoiceData"],[1,"header"],[1,"header-1"],[1,"title","start"],[1,"middle"],[1,"title"],[1,"header-2"],[1,"start","title"],[1,"end","title"],[1,"main"],["alt","organization-logo",3,"src"],[1,"company"],[1,"billed"],[4,"ngIf"],[1,"min-Height"],["cellspacing","0",1,"itemsTable"],[4,"ngFor","ngForOf"],["colspan","6"],[1,"text-nowrap"],[1,"price-icon"],[1,"total"],[1,"billing"],["cellspacing","0",1,"subTotal"],[1,"total_amount"],[1,"totalInwords"],[1,"amountTitle"],[1,"mt-3"],[1,"title","text-center"],[1,"stamp"],[1,"footer"]],template:function(a,n){1&a&&(t.TgZ(0,"mat-card")(1,"mat-card-header")(2,"h1",0),t._uU(3,"Actions"),t.qZA()(),t.TgZ(4,"mat-card-content")(5,"div",1)(6,"button",2),t.NdJ("click",function(){return n.printInvoice()}),t._uU(7," Print "),t.qZA(),t.TgZ(8,"button",2),t.NdJ("click",function(){return n.downloadPdf()}),t._uU(9," Download "),t.qZA(),t.TgZ(10,"button",2),t.NdJ("click",function(){return n.openConvertConfirmDialog()}),t._uU(11," Convert To Sale "),t.qZA()()()(),t.TgZ(12,"div",3),t.YNc(13,Te,124,24,"div",4),t.qZA()),2&a&&(t.xp6(13),t.Q6J("ngIf",n.invoiceDetails))},dependencies:[u.sg,u.O5,d.a8,d.dn,d.dk,f.lW,u.JJ,N.d],styles:["mat-card-content[_ngcontent-%COMP%]   .d-flex[_ngcontent-%COMP%]{gap:1rem}.total[_ngcontent-%COMP%]{justify-content:end}.total[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%}"]})}return i})()}];let xe=(()=>{class i{static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275mod=t.oAB({type:i});static#i=this.\u0275inj=t.cJS({imports:[g.Bz.forChild(Ze),g.Bz]})}return i})();var ye=c(8230),Ie=c(3298);let Ee=(()=>{class i{static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275mod=t.oAB({type:i});static#i=this.\u0275inj=t.cJS({providers:[v],imports:[u.ez,xe,ye.m,Ie.f]})}return i})()}}]);